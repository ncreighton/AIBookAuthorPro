<UserControl
    x:Class="AIBookAuthorPro.UI.Views.NotificationHost"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
    mc:Ignorable="d"
    d:DesignHeight="300"
    d:DesignWidth="400">

    <UserControl.Resources>
        <Style x:Key="NotificationCardStyle" TargetType="materialDesign:Card">
            <Setter Property="Margin" Value="0,0,0,8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="UniformCornerRadius" Value="8"/>
            <Setter Property="materialDesign:ElevationAssist.Elevation" Value="Dp4"/>
        </Style>

        <Storyboard x:Key="SlideInAnimation">
            <DoubleAnimation
                Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                From="400"
                To="0"
                Duration="0:0:0.3">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation
                Storyboard.TargetProperty="Opacity"
                From="0"
                To="1"
                Duration="0:0:0.2"/>
        </Storyboard>

        <Storyboard x:Key="SlideOutAnimation">
            <DoubleAnimation
                Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                From="0"
                To="400"
                Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimation
                Storyboard.TargetProperty="Opacity"
                From="1"
                To="0"
                Duration="0:0:0.2"/>
        </Storyboard>
    </UserControl.Resources>

    <ItemsControl
        x:Name="NotificationList"
        HorizontalAlignment="Right"
        VerticalAlignment="Top"
        Width="360"
        Margin="16">

        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Vertical"/>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>

        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <materialDesign:Card
                    Style="{StaticResource NotificationCardStyle}"
                    RenderTransformOrigin="0.5,0.5">
                    <materialDesign:Card.RenderTransform>
                        <TranslateTransform/>
                    </materialDesign:Card.RenderTransform>
                    <materialDesign:Card.Triggers>
                        <EventTrigger RoutedEvent="Loaded">
                            <BeginStoryboard Storyboard="{StaticResource SlideInAnimation}"/>
                        </EventTrigger>
                    </materialDesign:Card.Triggers>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Icon -->
                        <materialDesign:PackIcon
                            Grid.Column="0"
                            Kind="{Binding Icon}"
                            Width="24"
                            Height="24"
                            VerticalAlignment="Top"
                            Margin="0,0,12,0">
                            <materialDesign:PackIcon.Style>
                                <Style TargetType="materialDesign:PackIcon">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Type}" Value="Success">
                                            <Setter Property="Foreground" Value="#4CAF50"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Type}" Value="Warning">
                                            <Setter Property="Foreground" Value="#FF9800"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Type}" Value="Error">
                                            <Setter Property="Foreground" Value="#F44336"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Type}" Value="Info">
                                            <Setter Property="Foreground" Value="#2196F3"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </materialDesign:PackIcon.Style>
                        </materialDesign:PackIcon>

                        <!-- Content -->
                        <StackPanel Grid.Column="1">
                            <TextBlock
                                Text="{Binding Title}"
                                FontWeight="SemiBold"
                                FontSize="14"
                                Visibility="{Binding Title, Converter={StaticResource NullToVisibility}}"/>
                            <TextBlock
                                Text="{Binding Message}"
                                FontSize="13"
                                TextWrapping="Wrap"
                                Opacity="0.87"
                                Margin="0,4,0,0"/>

                            <!-- Action Button -->
                            <Button
                                Content="{Binding ActionText}"
                                Style="{StaticResource MaterialDesignFlatButton}"
                                Visibility="{Binding ActionText, Converter={StaticResource NullToVisibility}}"
                                HorizontalAlignment="Left"
                                Margin="-8,8,0,0"
                                Click="ActionButton_Click"/>
                        </StackPanel>

                        <!-- Dismiss Button -->
                        <Button
                            Grid.Column="2"
                            Style="{StaticResource MaterialDesignIconButton}"
                            Width="24"
                            Height="24"
                            VerticalAlignment="Top"
                            Visibility="{Binding IsDismissable, Converter={StaticResource BoolToVisibility}}"
                            Click="DismissButton_Click"
                            ToolTip="Dismiss">
                            <materialDesign:PackIcon Kind="Close" Width="16" Height="16"/>
                        </Button>
                    </Grid>
                </materialDesign:Card>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</UserControl>
